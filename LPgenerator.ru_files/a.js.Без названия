(function(g){function h(){return window.location.hostname}function l(b,c){"undefined"!==typeof c?console.log(h(),"[ANALYTICS]",c,":",b):console.log(h(),"[ANALYTICS]",b)}function n(b){if(null==b||"object"!=typeof b)return b;if(b instanceof Date){var c=new Date;c.setTime(b.getTime());return c}if(b instanceof Array){for(var c=[],a=0,k=b.length;a<k;a++)c[a]=n(b[a]);return c}if(b instanceof Object){c={};for(a in b)b.hasOwnProperty(a)&&b[a]!==document&&(c[a]=n(b[a]));return c}throw Error("Unable to copy obj! Its type isn't supported.");
}function t(b,c){b.prototype=new c;b.prototype.constructor=b}function w(b,c){var a="lpmident"+("undefined"!==typeof b?b:"");LPM.cookies.set(a,"undefined"!==typeof c?c:1,{expire_days:30});l("set skipping cookie ["+a+"]")}function A(b,c){if(/^#.*/.test(b))return b;var a=LPM.url.parseLink(b);if(a.query){var k=LPM.url.parseQueryString(a.query),f;for(f in c)c.hasOwnProperty(f)&&(k[f]=c[f]);a.query=LPM.url.buildQuery(k)}else a.query=LPM.url.buildQuery(c);return LPM.url.compileLink(a)}function B(){function b(){this.queue=
[];this.queueTimer=null;this.system="replace_me"}function c(){this.queue=[];this.queueTimer=null;this.system="ga"}function a(){this.queue=[];this.queueTimer=null;this.system="amplitude"}function k(){this.queue=[];this.queueTimer=null;this.system="carrotquest"}l("initiate objects");b.prototype.isDefined=function(){return"undefined"!==typeof g[this.system]};b.prototype.getSystem=function(){return this.system};b.prototype.hasQueue=function(){var a=0<this.queue.length;if(a){l("queue has "+this.queue.length+
" item(s)",this.system);if(null===this.queueTimer){l("run queue processing",this.system);var b=this;this.queueTimer=setInterval(function(){b.processQueue()},500)}return!0}return a};b.prototype.processQueue=function(){if(0<this.queue.length){var a=this.queue.shift();console.log(h(),"[ANALYTICS]",this.system,"processing queue item",a);this[a.func].apply(this,a.args)}else l("queue processing finished",this.system),clearInterval(this.queueTimer),this.queueTimer=!1,this.queue=[]};b.prototype.addToQueue=
function(a,b){this.queue.push({func:a,args:b})};b.prototype.getId=function(){return!1};b.prototype.sendEvent=function(a,b){};b.prototype.setProperties=function(a){};b.prototype.setUserId=function(a){};b.prototype.checkIdentification=function(a){var b=this.getId();!1!==b&&(b==a?w(this.system):(console.log(h(),"[ANALYTICS]",this.system,"setUserId to",a,"(now "+this.system+" id =",b,")"),this.setUserId(a)))};t(c,b);c.prototype.sendEvent=function(a,b){console.log(h(),"[ANALYTICS]",this.system,"sendEvent =",
a);ga("send",a)};c.prototype.setUserId=function(a){ga("set","userId",a)};c.prototype.getId=function(){if("undefined"===typeof g.ga||"function"!==typeof g.ga.getAll)return null;var a=ga.getAll(),b=null;if(0<a.length){var a=a.shift(),c;for(c in a)if(a.hasOwnProperty(c)&&"undefined"!==typeof a[c].data){b=c;break}if(null!==b&&"undefined"!==typeof a[b].data&&"undefined"!==typeof a[b].data.values&&"undefined"!==typeof a[b].data.values[":userId"])return l("GA userId = "+a[b].data.values[":userId"]),a[b].data.values[":userId"]}return null};
t(a,b);a.prototype.sendEvent=function(a,b){console.log(h(),"[ANALYTICS]",this.system,"sendEvent =",a);amplitude.getInstance().logEvent(a,b)};a.prototype.setProperties=function(a){var b=new amplitude.Identify,c;for(c in a)a.hasOwnProperty(c)&&b.set(c,a[c]);amplitude.identify(b)};a.prototype.setUserId=function(a){amplitude.getInstance().setUserId(a)};a.prototype.getId=function(){if("undefined"!==typeof g.amplitude){var a=amplitude.getInstance();if("undefined"!==typeof a&&"undefined"!==typeof a.options&&
"undefined"!==typeof a.options.userId)return a.options.userId}return null};t(k,b);k.prototype.sendEvent=function(a,b){console.log(h(),"[ANALYTICS]",this.system,"sendEvent =",a);carrotquest.track(a,b)};k.prototype.setProperties=function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push({op:"update_or_create",key:c,value:a[c]});carrotquest.identify(b)};d={amplitude:new a,google_analytics:new c,carrot:new k}}function x(){var b,c=!0,a=[];for(b in d)d.hasOwnProperty(b)&&(d[b].isDefined()?d[b].hasQueue():
(a.push(b),c=!1));c?l("everything is loaded"):(u+=200,2E4>=u?setTimeout(x,200):console.log(h(),"[ANALYTICS] stop waiting. Not loaded:",a))}function y(b){p=parseInt(b);return!isNaN(p)}function C(){this.flagIsReady=!1;this.init=function(){B();if("undefined"!==typeof g.lpmAnalyticEvents)for(var b=0;b<g.lpmAnalyticEvents.length;b++)switch(console.log(h(),"[ANALYTICS]","picking up event",g.lpmAnalyticEvents[b]),g.lpmAnalyticEvents[b].type){case "sendEvent":tracerSendEvent(g.lpmAnalyticEvents[b].event,
g.lpmAnalyticEvents[b].params||{});break;case "setAttrs":tracerSetAttrs(g.lpmAnalyticEvents[b].data);break;case "setUserId":tracerIdentify(g.lpmAnalyticEvents[b].id);break;case "remainedOnPage":tracerRemainedOnPage(g.lpmAnalyticEvents[b].event,g.lpmAnalyticEvents[b].seconds||10)}x();tracerTrackVisit();this.flagIsReady=g.lpmAnalyticReady=!0;FE.runAndClr("tracerService/ready")};this.isReady=function(){return this.flagIsReady}}var d={},u=0;(function(){window.LPM||(window.LPM={});window.LPM.url||(window.LPM.url=
{});window.LPM.url._private||(window.LPM.url._private={});window.LPM.url.encode||(window.LPM.url.encode=function(a){return encodeURIComponent(a+"").replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")});window.LPM.url.decode||(window.LPM.url.decode=function(a){return decodeURIComponent((a+"").replace(/%(?![\da-f]{2})/gi,function(){return"%25"}).replace(/\+/g,"%20"))});window.LPM.url.buildQuery||(window.LPM.url.buildQuery=function(a,
b,c){var e,d,m=[],g=function(a,b,c){var k,f=[];!0===b?b="1":!1===b&&(b="0");if(null!==b){if("object"===typeof b){for(k in b)b.hasOwnProperty(k)&&null!==b[k]&&f.push(g(a+"["+k+"]",b[k],c));return f.join(c)}if("function"!==typeof b)return LPM.url.encode(a).replace("%5B","[").replace("%5D","]")+"="+LPM.url.encode(b);throw Error("There was an error processing for http_build_query().");}return""};c||(c="&");for(d in a)a.hasOwnProperty(d)&&(e=a[d],b&&!isNaN(d)&&(d=String(b)+d),e=g(d,e,c),""!==e&&m.push(e));
return m.join(c)});window.LPM.url.compileLink||(window.LPM.url.compileLink=function(a){return(a.scheme?a.scheme+"://":"")+(a.host?a.host:"")+(a.path?a.path:"")+(a.query&&0<a.query.length?"?"+a.query:"")+(a.fragment?"#"+a.fragment:"")});window.LPM.url.parseLink||(window.LPM.url.parseLink=function(a){if("string"!==typeof a)return null;var b={scheme:null,user:null,pass:null,host:null,port:null,path:null,query:null,fragment:null},c=a.indexOf("://");0<=c&&(b.scheme=a.substr(0,c),a=a.substr(c+3));c=a.indexOf("#");
0<=c&&(b.fragment=a.substr(c+1),a=a.substr(0,c));c=a.indexOf("?");0<=c&&(b.query=a.substr(c+1),a=a.substr(0,c));c=a.indexOf("/");0<=c&&(b.path=a.substr(c),a=a.substr(0,c));var e=a.indexOf("@");0<=e?(c=a.substr(e+1),e=a.substr(0,e),a=e.indexOf(":"),0<=a?(b.user=e.substr(0,a),b.pass=e.substr(a+1)):b.user=e):c=a;a=c.indexOf(":");0<=a?(b.host=c.substr(0,a),b.port=c.substr(a+1)):b.host=""==c?null:c;return b});window.LPM.url._private._parseQueryKeyWithBrackets||(window.LPM.url._private._parseQueryKeyWithBrackets=
function(a,b,c){a||(a={});var e=(b+"").indexOf("[");if(-1<e){var d=String(b).length,g="",h=LPM.url.decode(b.substring(0,e));a[h]={};for(var l=a[h];e<d;e++)"["==b.charAt(e)?g="":"]"==b.charAt(e)?(l[g]={},a=l,l=l[g],h=LPM.url.decode(g)):g+=b.charAt(e);a[h]=c}else a[LPM.url.decode(b)]=LPM.url.decode(c)});window.LPM.url.parseQueryString||(window.LPM.url.parseQueryString=function(a){a=(a+"").replace(/^&/,"").replace(/^\?/,"").replace(/&$/,"").split("&");for(var b={},c,e=0;e<a.length;e++)c=a[e].indexOf("="),
-1<c?window.LPM.url._private._parseQueryKeyWithBrackets(b,a[e].substring(0,c),a[e].substring(c+1)):b[LPM.url.decode(a[e])]="";return b});window.LPM.url.getQueryVariable||(window.LPM.url.getQueryVariable=function(a,b,c){a=LPM.url.parseQueryString(a);return"undefined"!==typeof a[b]?a[b]:c});var b="",c="";window.LPM.url.setHost||(window.LPM.url.setHost=function(a){window.unitTest&&(b=a)});window.LPM.url.getHost||(window.LPM.url.getHost=function(){return window.unitTest?b:window.location.hostname});window.LPM.url.getRootDomain||
(window.LPM.url.getRootDomain=function(){var a=(window.unitTest?b:window.location.hostname).match(/([^.]+).([^.]+)$/);return null!==a?a[1]+"."+a[2]:window.LPM.url.getHost()});window.LPM.url.setReferrer||(window.LPM.url.setReferrer=function(a){c=window.unitTest?"undefined"===typeof a?"":a:""});window.LPM.url.getReferrer||(window.LPM.url.getReferrer=function(a){"undefined"===typeof a&&(a="");return window.unitTest?""!==c?c:a:document.referrer&&0<document.referrer.length?document.referrer:a})})();(function(b){window.LPM||
(window.LPM={});window.LPM.cookies||(window.LPM.cookies={});var c={};window.LPM.cookies.get||(window.LPM.cookies.get=function(a,b){if(window.unitTest)return"undefined"!==typeof c[a]?c[a].value:b;var f=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return f?decodeURIComponent(f[1]):b});window.LPM.cookies.set||(window.LPM.cookies.set=function(a,b,f){if("undefined"===typeof f||"object"!==typeof f)f={};if(window.unitTest)f.value=b,c[a]=f;else{if(f.expire_days){var e=
new Date;e.setTime(e.getTime()+864E5*f.expire_days);f.expires=e.toGMTString()}document.cookie=a+"="+encodeURIComponent(b)+(f.hasOwnProperty("expires")?"; expires="+new Date(f.expires):"")+(f.hasOwnProperty("path")?"; path="+f.path:"")+(f.hasOwnProperty("domain")?"; domain="+f.domain:"")+(f.hasOwnProperty("secure")?"; secure":"")}});window.LPM.cookies["delete"]||(window.LPM.cookies["delete"]=function(a){var b=0;if(window.unitTest)if(Array.isArray(a))for(b=0;b<a.length;b++)"undefined"!==typeof c[a[b]]&&
delete c[a[b]];else"undefined"!==typeof c[a]&&delete c[a];else if(Array.isArray(a))for(b=0;b<a.length;b++)LPM.cookies.set(a[b],"",{expires:-1});else LPM.cookies.set(a,"",{expires:-1})});window.LPM.cookies.deleteAll||(window.LPM.cookies.deleteAll=function(){if(window.unitTest){for(var a in c)c.hasOwnProperty(a)&&delete c[a];c={}}})})();var q=window.location.pathname;"undefined"===typeof window.trim&&(window.trim=function(b){return b.replace(/^\s+/,"").replace(/\s+$/,"")});g.debugAnalytic={getObj:function(b){return d[b]},
overrideDefined:function(b,c){switch(c){case !0:d[b].isDefined=function(){return!0};break;case !1:d[b].isDefined=function(){return!1};break;case null:d[b].isDefined=function(){return"undefined"!==typeof g[this.system]}}}};var r="utm_source utm_campaign utm_medium utm_content utm_term utm_ref_id utm_referrer utm_start_url utm_root_domain utm_promo".split(" "),z=window.LPM.cookies;g.tracerSendEvent=function(b,c){c=c||{};console.log(h(),"[ANALYTICS] send Event [",b,"] with params =",c);for(var a in d)d.hasOwnProperty(a)&&
(d[a].isDefined()&&!d[a].hasQueue()?d[a].sendEvent(b,n(c)):d[a].addToQueue("sendEvent",[b,n(c)]))};g.tracerSetAttrs=function(b){if("object"!==typeof b)l("properties is empty");else{console.log(h(),"[ANALYTICS] set user Attrs =",b);for(var c in d)d.hasOwnProperty(c)&&(d[c].isDefined()&&!d[c].hasQueue()?d[c].setProperties(b):d[c].addToQueue("setProperties",[b]))}};g.tracerIdentify=function(b){if(0<b){console.log(h(),"[ANALYTICS] set user id =",b);for(var c in d)d.hasOwnProperty(c)&&(d[c].isDefined()&&
!d[c].hasQueue()?d[c].setUserId(b):d[c].addToQueue("setUserId",[b]))}else console.log(h(),"[ANALYTICS] can not set user id because userId has wrong value:",b)};g.tracerCheckIdentification=function(b){if(0<b){console.log(h(),"[ANALYTICS] check identification for user",b);var c=0,a;for(a in d){var k;if(k=d.hasOwnProperty(a))k=d[a].getSystem(),k="lpmident"+("undefined"!==typeof k?k:""),1==LPM.cookies.get(k,"")?(l("has cookie ["+k+"] -> already identified"),k=!0):k=!1,k=!k;k&&(!1!==d[a].getId()&&c++,
d[a].isDefined()&&!d[a].hasQueue()?d[a].checkIdentification(b):d[a].addToQueue("checkIdentification",[b]))}return c}console.log(h(),"[ANALYTICS] can not check identification because userId has wrong value: wrong userId",b);return null};g.tracerRemainedOnPage=function(b,c){if(window.JSON){var a=window.location.protocol+"//"+h()+q;console.log(h(),"[ANALYTICS] scheduled event [",b,"] after",c,"sec");var d=setTimeout,a="tracerSendEvent("+["'"+b.replace(/'/g,"\\'")+"'",JSON.stringify({seconds:c,url:a})].join()+
")";d(a,1E3*c)}};g.tracerTrackVisit=function(){var b={},c=LPM.url.parseLink(window.location.href);null!==c.query&&(b=LPM.url.parseQueryString(c.query));if(/^\/analytics\/blank/.test(q)){if("undefined"!==typeof b.action)switch(b.action){case "identify":if(b.user_id&&0<tracerCheckIdentification(b.user_id)){var b=tracerSendEvent,a;a=window.location.hostname.match(/([^.]+).([^.]+)$/);a=null!==a?a[1]+"."+a[2]:h();b("_visited landing in frame",{type:a})}break;default:console.log(h(),"[AMP Visit] wrong action")}}else if(!/^\/admin\//.test(q)){for(var d=
window.location.href,c={},f=0;f<r.length;f++){var e=r[f],l=z.get(e,null);null!==l&&(c[e]=l)}c.utm_start_url&&""!=c.utm_start_url||"undefined"!==typeof d&&0<(d+"").length&&(c.utm_start_url=d);f=window.LPM.url.getReferrer();0<f.length&&(c.utm_referrer=f);c.utm_root_domain||(c.utm_root_domain=window.LPM.url.getRootDomain());f=LPM.cookies.get("_plink_",null);null!==f&&(c.utm_promo=f);f=LPM.url.parseLink(d);if(null!==f.query){d={};f=LPM.url.parseQueryString(f.query);for(l=0;l<r.length;l++)e=r[l],f.hasOwnProperty(e)&&
(d[e]=f[e]);for(var m in d)d.hasOwnProperty(m)&&(c[m]=d[m])}m=document.getElementsByTagName("a");d=0;f="";for(e=0;e<m.length;e++)if(f=m[e].getAttribute("href"))m[e].setAttribute("href",A(f,c)),d++;if("object"===typeof c)for(a in c)c.hasOwnProperty(a)&&z.set(a,c[a],{expire_days:30});if("admin.bmtower1.bz"!==window.location.host){a=h();c=a.match(/^www[.]+(.*)$/i);null!==c&&(a=c[1]);a={type:a,landing:a,url:window.location.protocol+"//"+h()+q};c=["utm_source","utm_medium","utm_content","utm_term","utm_campaign"];
for(m=0;m<c.length;m++)"undefined"!==typeof b[c[m]]&&(a[c[m]]=decodeURIComponent(b[c[m]]));document.referrer&&0<document.referrer.length&&(a.referrer=decodeURI(document.referrer));g.LpmBase64&&(b=LPM.cookies.get("lplnk",null),null!==b&&0<b.length&&(a.promocode=LpmBase64.decode(b)));tracerSendEvent("visited landing",a);tracerRemainedOnPage("remained on landing",10)}}};var p=null,D=0,v="lpmotor.biz bm360.ru autofunnels.pro avtovoronka-prodazh.ru sozdanie-lending-peidzh.ru xn-----6kcbbtcuokc6bbbfec0bjjhigk2jren.xn--p1ai xn-----1-l4dfcedlrpfaq3aeckc4akcuzcz.xn--p1ai generator.lpmotor.biz".split(" ");
g.tracerIdentifyOnAllDomains=function(b){"undefined"!==typeof b&&0<(b+"").length&&0<b?b=y(b):"undefined"!==typeof window.userId?b=y(window.userId):(20>D++?(l("waiting for userId"),setTimeout("tracerIdentifyOnAllDomains()",500)):l("stopped waiting for userId"),b=!1);if(b){tracerCheckIdentification(p);b=p;var c;c=LPM.cookies.get("lpmidentspread");if("undefined"===typeof c||5>c){for(var a=0;a<v.length;a++){l("create frame for "+v[a]);var d=window.location.protocol+"//"+v[a]+"/analytics/blank",f={action:"identify",
user_id:b},e=document.createElement("iframe"),g=[];g.push("rnd="+1*new Date);var h=void 0;for(h in f)f.hasOwnProperty(h)&&g.push(h+"="+f[h]);e.className="analytic-spread-frame";e.src=d+"?"+g.join("&");e.style="position: fixed; top: -999px; left: -999px; width: 1px; height: 1px;";document.body.appendChild(e)}w("spread","undefined"===typeof c?0:parseInt(c)+1)}}};FE.runOnReady(function(){window.tracerService=new C;window.tracerService.init()});l("file loaded")})(window);
